<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://perevillega.com name=base><title>Software serves the Business • Java Persistence API</title><link href=https://perevillega.com/icons/favicon.ico rel=icon type=image/png><link title="Software serves the Business - Atom Feed" href=https://perevillega.com/atom.xml rel=alternate type=application/atom+xml><link href="https://perevillega.com/inter_subset_en.css?h=d8cf4ad058d6c3a4015b" rel=stylesheet><link href="https://perevillega.com/main.css?h=149ff9e737409b86f9c3" rel=stylesheet><meta content="light dark" name=color-scheme><meta content=#087e96 name=theme-color><meta content="This page contains a brief summary of Java Persistence API (JPA). It only gives basic information, for more details about life cycle and other functionalities check the EJB 3.0 reference or some book like EJB3 in Action.
…" name=description><meta content="This page contains a brief summary of Java Persistence API (JPA). It only gives basic information, for more details about life cycle and other functionalities check the EJB 3.0 reference or some book like EJB3 in Action.
…" property=og:description><meta content="index, nofollow" name=robots><meta content="Java Persistence API" property=og:title><meta content=article property=og:type><meta content="https://perevillega.com/social_cards/index.png?h=125d02cc3c86eaf88fa6" property=og:image><meta content=2088 property=og:image:width><meta content=1000 property=og:image:height><meta content="https://perevillega.com/social_cards/index.png?h=125d02cc3c86eaf88fa6" name=twitter:image><meta content=summary_large_image name=twitter:card><meta content=en_GB property=og:locale><meta content=https://perevillega.com/posts/java-persistence-api/ property=og:url><meta content="Software serves the Business" property=og:site_name><meta content="default-src 'self';font-src 'self' data: 'self';img-src 'self' https://* data:;media-src 'self' https://cdn.jsdelivr.net/;style-src 'self' 'unsafe-inline';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self' https://umami.villegawilcz.com;script-src 'self' https://umami.villegawilcz.com 'self'" http-equiv=Content-Security-Policy><noscript><link href=https://perevillega.com/no_js.css rel=stylesheet></noscript><script src=https://perevillega.com/js/initializeTheme.min.js></script><script defer src=https://perevillega.com/js/themeSwitcher.min.js></script><script async data-do-not-track=true data-website-id=7bdfa858-bebc-479d-9a1f-bea833a709a8 defer src=https://umami.villegawilcz.com/script.js></script><meta content=@pvillega@mastodon.social name=fediverse:creator><script src="https://perevillega.com/search_index.en.js?h=791a6da9678059241bea" defer></script><script src="https://perevillega.com/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://perevillega.com>Software serves the Business</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://perevillega.com/posts/> blog </a><li><a class="nav-links no-hover-padding" href=https://perevillega.com/tags/> tags </a></li><div class=nav-navs id=menu-icons-group><li class=js><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></div></ul></div></nav></header><div class=content><main><article><h1 class=article-title>Java Persistence API</h1><ul class=meta><li>10th Feb 2010<li title="3010 words"><span aria-hidden=true class=separator>•</span>16 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a href=https://perevillega.com/tags/java/>java</a>, <li class=tag><a href=https://perevillega.com/tags/ejb/>ejb</a>, <li class=tag><a href=https://perevillega.com/tags/jpa/>jpa</a></ul><section class=body><p>This page contains a brief summary of <strong>Java Persistence API (JPA)</strong>. It only gives basic information, for more details about life cycle and other functionalities check the EJB 3.0 reference or some book like <strong>EJB3 in Action</strong>.</p><span id=continue-reading></span><p>Persistence is probably one of the biggest concerns of most enterprise applications. Data is key and we have to be sure it’s consistent and our application can manage its changes properly. To that end lots of alternatives have been developed, with O/R mapping systems taking the led in the latest years due to the benefits of using an intermediate API that’s closer to the OO model used in the business layer instead of direct interaction with the RDBMS.<p>EJB entities are the answer of EJB 3,0 to the persistence issue and it’s implementation using JPA follows the same basic patterns as other components like session beans. That means they are POJOs with specific annotations (@Entity for JPA entities) that are capable of inheritance and whose non-abstract classes requires a public or protected no-argument constructor.<p>JPA is the most complex part of EJB 3.0. Not only controls the most critical component of our application but it provides a large number of options for a developer to be able to adapt it to his needs. I will try to break this complexity in some sections, like they do in the book EJB in Action, focussing on a few aspects of JPA. Remember this is just a quick summary that won’t cover lots of aspects of JPA.<h2 id=basic-domain-concepts-entities-and-primary-keys><a aria-label="Anchor link for: basic-domain-concepts-entities-and-primary-keys" class="header-anchor no-hover-padding" href=#basic-domain-concepts-entities-and-primary-keys><span aria-hidden=true class=link-icon></span></a> Basic domain concepts: entities and primary keys</h2><p>As said above JPA is an O/R mapping system. That means it maps Java POJOs (objects) to data stored in the database as tables and rows (relational data). To achieve this JPA does a heavy use of annotations. In this section I will show basic POJOs with some common annotations and explain how they are used. That will enables us to map our tables to the application, although by itself it won’t let our application work. Let’s start with a basic entity:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">BasicEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">private</span> <span class="z-storage z-modifier z-java">static</span> <span class="z-storage z-modifier z-java">final</span> <span class="z-storage z-type z-primitive z-java">long</span> <span class="z-meta z-field z-java">serialVersionUID</span> <span class="z-meta z-assignment z-rhs z-java"><span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-numeric z-integer z-decimal z-java">1<span class="z-storage z-type z-numeric z-java">L</span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">GeneratedValue</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">strategy</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-support z-class z-java">GenerationType</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-constant z-other z-java">AUTO</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">private</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Transient</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">private</span> <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">disposableCode</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-block z-documentation z-javadoc"><span class="z-punctuation z-definition z-comment z-begin z-javadoc">/**</span></span><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">   <span class="z-punctuation z-definition z-comment z-javadoc">*</span> Get the value of disposableCode
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">   <span class="z-punctuation z-definition z-comment z-javadoc">*</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">   <span class="z-punctuation z-definition z-comment z-javadoc">*</span> <span class="z-meta z-block-tag z-javadoc"><span class="z-keyword z-other z-documentation z-javadoc"><span class="z-punctuation z-definition z-keyword z-javadoc">@</span>return</span> the value of disposableCode
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">   <span class="z-punctuation z-definition z-comment z-javadoc">*</span>/
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  public String getDisposableCode() {
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">    return disposableCode;
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  }
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  /**
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">   <span class="z-punctuation z-definition z-comment z-javadoc">*</span> Set the value of disposableCode
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">   <span class="z-punctuation z-definition z-comment z-javadoc">*</span>
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc"></span>   <span class="z-punctuation z-definition z-comment z-javadoc">*</span> <span class="z-meta z-block-tag z-javadoc"><span class="z-keyword z-other z-documentation z-param z-javadoc"><span class="z-punctuation z-definition z-keyword z-javadoc">@</span>param</span> <span class="z-variable z-parameter z-javadoc">disposableCode</span> new value of disposableCode
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">   <span class="z-punctuation z-definition z-comment z-javadoc">*</span>/
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  public void setDisposableCode(String name) {
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">    this.disposableCode = name;
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  }
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  public Long getId() {
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">    return id;
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  }
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  public void setId(Long id) {
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">    this.id = id;
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">  }
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc">
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc"><span class="z-meta z-block-tag z-javadoc"></span>  @Override
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  public int hashCode() {
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    int hash = 0;
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    hash += (id != null ? id.hashCode() : 0);
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    return hash;
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  }
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  @Override
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  public boolean equals(Object object) {
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    // TODO: Warning - this method won't work if id fields are not set
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    if (!(object instanceof BasicEntity)) {
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">        return false;
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    }
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    BasicEntity other = (BasicEntity) object;
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    if ((this.id == null && other.id != null)
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">        || (this.id != null && !this.id.equals(other.id))) {
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">        return false;
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    }
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    return true;
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  }
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  @Override
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  public String toString() {
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">    return "jpa.BasicEntity[id=" + id + "]";
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">  }
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">}
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-comment z-block z-documentation z-javadoc"><span class="z-text z-html z-javadoc">
</span></span></span></span></span></span></code></pre><p>In this example we can see some interesting characteristics of an entity. First one, the entity is marked with the @Entity annotation, that identifies this POJO as an EJB 3,0 entity. Another important step is to override the methods hashcode, equals and toString. This is not mandatory but it’s considered a best practice to implement hashcode and equals so they use our primary key to identify our entity, and changing toString allows us to log and debug the application easily.<p>The persistence provider will store the values of any property or field that has public or protected setters and getters, which can’t be declared final, so no especial annotation is required to enable their persistence. In this example you can see we use a @Transient annotation in one field. This is equivalent to the transient keyword related to Serialization and tells the persistence manager to not persist that specific field.<p>Another detail about the annotations: in this example they are on the fields of the classes. You could write them on the getter methods of those fields, but whatever system you choose you have to stick to it for all you entities. The only difference is that using field-annotation you could make your fields public and not use any getter or setter method and they would be persisted, while using the annotation in the getter method obliges you to implement all the getters/setters and make the field private. Given that the first way is a very dangerous and bad practice, so you will have a private field with getter and setters in your entities, choosing one over the other is usually a matter of taste.<p>I’ve left the @Id annotation for last. This annotation, as you can guess, tells the entity where is stored our unique id. The field that can be marked as Id has some restrictions: it must be a primitive, its wrapper or a Serializable type. Types like double or float are forbidden due to their lack of precision (due to the way computers work, you should know what I mean) and that could cause two different entities to be considered the same.<p>But the @Id annotation is marking only one field and we can’t have more than one @Id in our class, so what happens if we have a primary key that uses several fields? There are two approaches to it.<p>The first approach uses the @IdClass annotation as follows:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">IdClass</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">BasicEntityPK</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-variable z-language z-java">class</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">BasicEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">private</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">private</span> <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">name</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other non Id fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>no need to implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">BasicEntityPK</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">   <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">   <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">name</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">   <span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-method z-java"><span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-constructor z-java">BasicEntityPK</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><p>As you can see we have our main entity class with several @Id fields assigned and a related class that contains the same fields. In this case we implement the equals and hashcode methods in the PK class, not in our entity. With this approach the container will use the entity to persist data and will map internally the fields to the PK class, which will be used when it needs to compare two entities.<p>The other alternative is the use of the @EmbeddedId annotation, like this:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">BasicEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">EmbeddedId</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">private</span> <span class="z-support z-class z-java">BasicEntityPK</span> <span class="z-meta z-field z-java">basicEntityPk</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>no need to implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Embeddable</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">BasicEntityPK</span></span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">name</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-method z-java"><span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-constructor z-java">BasicEntityPK</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><p>The skeleton is quite similar to the @IdClass one but in this case instead of having the primary key fields on both classes, we just put them in our PK class, and we embed that class into our entity as its primary key. Choosing between any of those methods is a matter of personal taste: one is harder to maintain due to replication, the other makes access to PK fields more awkward. Keep in mind that although you can use those structures sometimes is preferable the use of a surrogate key (we will review it later) as Id, as it will free you code from extra classes and it has better performance.<p>Now that we have talk about the @Embeddable annotation it might be a good time to explain its meaning. In our data model we may have some data that’s always related to a certain object but that has sense by itself, like the address of a user. This address contains several fields (city, street) so it may be an entity but it’s always related to a user. So in the object model it makes sense to implement it as its own object but in the relational model it will be in the same table as the user. To solve this JPA has the option to embed objects into entities, allowing us to declare this kind of relationship. An example:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">UserEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">name</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Embedded</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Address</span> <span class="z-meta z-field z-java">address</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Embeddable</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">Address</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">street</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">city</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><h2 id=basic-domain-concepts-entities-relationships><a aria-label="Anchor link for: basic-domain-concepts-entities-relationships" class="header-anchor no-hover-padding" href=#basic-domain-concepts-entities-relationships><span aria-hidden=true class=link-icon></span></a> Basic domain concepts: entities relationships</h2><p>The data components in our model will have some kind of relationships between them: one-to-one, one-to-many, many-to-one or many-to-many. These relationships must be defined in our entities so the persistence provider can maintain the proper relations and the data consistency. In this section I will describe the annotations that manage that.<p>First one is the @OneToOne annotation, that defines a one-to-one relationship.This relationship can be unidirectional or bidirectional. Let’s start with a bidirectional one:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">UserEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">OneToOne</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">VisaInfoEntity</span> <span class="z-meta z-field z-java">visaInfoEntity</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">VisaInfoEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">OneToOne</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">mapedBy</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>visaInfoEntity<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">optional</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>false<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">UserEntity</span> <span class="z-meta z-field z-java">userEntity</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><p>In this example we see the relation defined by the annotations in the parameters. Each class contain a parameter of the class that represents the entity related to it marked with @OneToOne. Notice that VisaInfoEntity adds some parameters to it’s annotation, telling the persistence provider that the “owner” of the relation is the UserEntity class and which field is leading that mapping. The optional parameter set to false tells us there will always be a VisaInfoEntity for each user and a user for each VisaInfoEntity. If we want to convert this to a unidirectional link we just need to remove the reference to UserEntity and its annotation from VisaInfoEntity. With that the container will know our UserEntity may have zero or one VisaInfoEntity related to it.<p>The second type of relation is defined by the annotations @OneToMany and @ManyToOne. Those annotations usually go in pair to define both sides of the relation one-to-many. Usually in these relations one entity has a field of type Set or List of the other entity. One example:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">UserEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">OneToMany</span> </span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">mappedBy</span> <span class="z-keyword z-operator z-assignment z-java">=</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>userEntity<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Set</span> <span class="z-meta z-field z-java">visaInfoEntity</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">VisaInfoEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">ManyToOne</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">UserEntity</span> <span class="z-meta z-field z-java">userEntity</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><p>As you can see the owning part of the relation is VisaInfoEntity. In these type of relations the many-to-one part is always the leader, something to be aware of.<p>Last type of relations is defined by the annotation @ManyToMany. The relation is quite similar to the one-to-many explained above, but we can choose which entity is leading the relationship. An example:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">UserEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">ManyToMany</span> </span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">mappedBy</span> <span class="z-keyword z-operator z-assignment z-java">=</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>userEntity<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Set</span> <span class="z-meta z-field z-java">visaInfoEntity</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">VisaInfoEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">ManyToMany</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Set</span> <span class="z-meta z-field z-java">userEntity</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>other fields
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>implement equals and hashcode
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>getters and setters
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><h2 id=mapping-entities-to-db><a aria-label="Anchor link for: mapping-entities-to-db" class="header-anchor no-hover-padding" href=#mapping-entities-to-db><span aria-hidden=true class=link-icon></span></a> Mapping entities to DB</h2><p>We know how to build entities and define relations between them. Now we need to map those entities to the tables of the database, as we will see next. Before looking at the example, be aware that using annotations for that purpose hard-codes the structure, so any changes to it will require a new version of the application. This is usually not a big deal but if you need to be able to change the mappings without compiling, use the XML descriptor version of the fields.<p>Next there’s an example of a mapped entity. The meaning of the annotations is quite obvious, I will comment them after the code:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Table</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USERS<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">SecondaryTable</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USER_PICTURES<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-parameters z-java">   <span class="z-variable z-parameter z-java">pkJoinColumns</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">PrimaryKeyJoinColumn</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USER_ID<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">UserEntity</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">private</span> <span class="z-storage z-modifier z-java">static</span> <span class="z-storage z-modifier z-java">final</span> <span class="z-storage z-type z-primitive z-java">long</span> <span class="z-meta z-field z-java">serialVersionUID</span> <span class="z-meta z-assignment z-rhs z-java"><span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-numeric z-integer z-decimal z-java">1<span class="z-storage z-type z-numeric z-java">L</span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Id</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Column</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USER_ID<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">nullable</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-language z-java">false</span><span class="z-punctuation z-separator z-comma z-java">,</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-parameters z-java">     <span class="z-variable z-parameter z-java">insertable</span><span class="z-keyword z-operator z-assignment z-java">=</span><span class="z-constant z-language z-java">false</span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">updatable</span><span class="z-keyword z-operator z-assignment z-java">=</span><span class="z-constant z-language z-java">false</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">GeneratedValue</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">strategy</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-support z-class z-java">GenerationType</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-constant z-other z-java">AUTO</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Long</span> <span class="z-meta z-field z-java">id</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Column</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USER_NAME<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">nullable</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-language z-java">false</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">name</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Column</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USER_LOGIN<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">nullable</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-language z-java">false</span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">length</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-numeric z-integer z-decimal z-java">5</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">String</span> <span class="z-meta z-field z-java">login</span><span class="z-punctuation z-terminator z-java">;</span> <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Enumerated</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">EnumType</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-constant z-other z-java">ORDINAL</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Column</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USER_TYPE<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">nullable</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-language z-java">false</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">UserType</span> <span class="z-meta z-field z-java">userType</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Column</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>PICTURE<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">table</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>USER_PICTURES<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Lob</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Basic</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">fetch</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-support z-class z-java">FetchType</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-constant z-other z-java">LAZY</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-storage z-type z-primitive z-java">byte</span><span class="z-storage z-modifier z-array z-java">[]</span> <span class="z-meta z-field z-java">picture</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Column</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>CREATION_DATE<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span> <span class="z-variable z-parameter z-java">nullable</span> <span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-constant z-language z-java">false</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Temporal</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">TemporalType</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-constant z-other z-java">DATE</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Date</span> <span class="z-meta z-field z-java">creationDate</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Embedded</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java">  </span></span><span class="z-storage z-modifier z-java">protected</span> <span class="z-support z-class z-java">Address</span> <span class="z-meta z-field z-java">address</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>setters, getters, hashcode, equals, etc
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Embeddable</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">Address</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>fields, setters, getters, hashcode, equals, etc
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><p>The first annotation which we must pay attention to is @Table. This annotation specifies which table contains the columns we will use for the entity. If not specified (both the name or the tag) the system will use a table with the same name as the class.<p>The @Column annotation declares the mapping to a column of the table. As you can see, accepts some extra parameters to indicate if the field can be null or it can be modified using update or insert. The persistence manager assumes the columns exist in the class table, but you can specify another table if needed as you can see at the picture field. As with the @Table annotation, if you don’t define the name of the column or you8 don’t add the annotation it will be assumed the column has the same name as the field.<p>There are some extra annotations for specific types of data. The @Enumerated annotation allows us to store enumerations. We can use two modes: Ordinal or String. The first will store the integer associated to the enumeration value while the second will store the complete string.<p>The @Lob annotation tell the manager this field will be stored in a CLOB (for char[] or String fields) or BLOB (any other type) column in the database. Usually you add the @Basic annotation to a @Lob object to enable lazy loading, as @Lob objects are usually very memory intensive.<p>The @Temporal allows us to store date-related information. By default it uses a granularity of timestamp, but we can choose between DATE, TIME or TIMESTAMP.<p>For the primary key of the application you may use (if it’s a surrogate key) the @GeneratedValue annotation. This annotation will tell the persistence manager the field’s value is generated by the database. That means it will only exist once the entity has been committed, so we careful when accessing items not committed yet as they will have a null here.<p>The @GeneratedValue annotation has 4 available strategies to assign the value. The simplest one is IDENTITY and assigns an incremental value to the key. The second one is SEQUENCE, that requires a sequence to be defined both in the database and in EJB (using @SequenceGenerator). The third one is TABLE, which uses a a table as generator of the values (with @TableGenerator). The last strategy is AUTO, where the persistence manager decides which one is the best strategy.<p>I have skipped an annotation in the class header, @SecondaryTable. This one is used when we need to map an entity to several tables, in this case because we store the BLOB object in another table. As you can see, we tell the annotation which table it has to use and the name of join field. You can use several secondary tables in the same entity. Although this annotation doesn’t seem so useful, it allows you to distribute content on several tables, which can improve the performance of the RDBMS as it happens in this example where the BLOB would slow queries done to the user table. That said be aware that this annotation is not the same as @Embedded, which we saw before and refers to content in the same table.<p>As you look at the code, you might wonder if maybe we need to specify join keys for tables relationship as we did in the @SecondaryTable annotation. The answer is yes, there are some annotations (three) to that end. I will briefly comment them:<ul><li><strong>@JoinColumn</strong>: this annotation allows you to specify primary/foreign relations in the database model, when the referencing entity has a primary key and the referenced entity it’s own primary key and a foreign key mapped to the primary key of the referencing entity. It can be used in one-to-one and one-to-many/many-to-one relations.<li><strong>@PrimaryKeyJoinColumn</strong>: this annotation allows you to specify primary/foreign relations in the database model when both referencing and referenced entities share the primary key of the referencing table and the referenced table uses it’s primary key as foreign key. It can be used in one-to-one relations.<li><strong>@JoinTable</strong>: this annotation allows you to specify primary/foreign relations in the database model when you have a many-to-many relation so you need to use an intermediate table to store the mappings. Is used in conjunction with the @JoinColumn annotation to specify the relation between the main tables and the intermediate one.</ul><p>One last subject to talk about is how to map inheritance. As we said, JPA are POJO and they can use OO characteristics as inheritance, but how can we write that into the database? I won’t enter in too much detail, but to this aim we have the @Inheritance annotation. It has 3 related strategies:<ul><li><strong>Single table</strong>: all data of the different subclases will be stored in the same table and we use one column (specified in the @DiscriminatorColumn annotation) to differentiate between subclasses. Each subclass will be marked with @DiscriminatorValue to tell the persistence manager which value maps to that type of entity.<li><strong>Joined Tables</strong>: we use one-to-one relations to model the inheritance. @DiscriminatorColumn and @DiscriminatorValue are used the same way but we also need to define the @PrimaryKeyJoinColumn between the tables. Is the recommended method.<li><strong>Table per class</strong>: we use one table per class, including one for the parent entity. No relations must be defined, and the inherited columns are duplicated across tables.Due to possible issues with polymorphism and entity retrieving, is not recommended to use this method</ul><h2 id=entity-manager><a aria-label="Anchor link for: entity-manager" class="header-anchor no-hover-padding" href=#entity-manager><span aria-hidden=true class=link-icon></span></a> Entity Manager</h2><p>We’ve seen how to map the entities to the database, but you’ll probably noticed I said nothing about how the entities are persisted. This section will talk about the Entity Manager, the interface responsible of all CRUD operations that allows you to retrieve and store entities from/into the database. An important consequence of this is that JPA being managed by this interface and not the container they don’t have access to services like injection, timers, etc. It’s not a big loose due to the way entities are (commonly) used but it’s something to be aware of. I won’t talk about the lifecycle in detail, just keep in mind the Entity Manager is only aware of entities in it’s context (that can be as short as a method call or as long as a session), and an entity is not managed until you persist it.<p>A basic demonstration of the use of the Entity Manager follows. I won’t comment the code as it’s quite obvious:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Stateless</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">ItemManagerBeanBean</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">ItemManagerBeanLocal</span> </span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">PersistenceContext</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">unitName</span><span class="z-keyword z-operator z-assignment z-java">=</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>contextName<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">private</span> <span class="z-support z-class z-java">EntityManager</span> <span class="z-meta z-field z-java">em</span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">public</span> <span class="z-support z-class z-java">Item</span> <span class="z-meta z-method z-java"><span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-java">addItem</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">String</span><span class="z-storage z-modifier z-array z-java">[]</span> <span class="z-meta z-path z-java"><span class="z-support z-type z-package z-java">params</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-punctuation z-accessor z-dot z-java">.</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-support z-class z-java">Item</span> it <span class="z-meta z-assignment z-rhs z-java"><span class="z-keyword z-operator z-assignment z-java">=</span> <span class="z-meta z-instantiation z-java"><span class="z-keyword z-other z-storage z-new z-java">new</span> <span class="z-support z-class z-java">Item</span><span class="z-meta z-parens z-constructor-arguments z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>do something
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">persist</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span>it<span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-keyword z-control z-flow z-return z-java">return</span> it<span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">  <span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">public</span> <span class="z-support z-class z-java">Item</span> <span class="z-meta z-method z-java"><span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-java">updateItem</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">Item</span> <span class="z-variable z-parameter z-java">it</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">merge</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span>it<span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-keyword z-control z-flow z-return z-java">return</span> it<span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">  <span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">public</span> <span class="z-support z-class z-java">Item</span> <span class="z-meta z-method z-java"><span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-java">undoItemChanges</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">Item</span> <span class="z-variable z-parameter z-java">it</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>we merge to attach to the entity manager before refreshing
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">refresh</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span>em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">merge</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span>it<span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-keyword z-control z-flow z-return z-java">return</span> it<span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">  <span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-method z-java"><span class="z-storage z-type z-void z-java">void</span> <span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-java">deleteItem</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">Item</span> <span class="z-variable z-parameter z-java">it</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>we merge to attach to the entity manager before removing
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">remove</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span>em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">merge</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span>it<span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">  <span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">public</span> <span class="z-support z-class z-java">Item</span> <span class="z-meta z-method z-java"><span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-java">getItem</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-storage z-type z-primitive z-java">long</span> <span class="z-variable z-parameter z-java">key</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">    <span class="z-keyword z-control z-flow z-return z-java">return</span> em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">find</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">Item</span><span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-variable z-language z-java">class</span><span class="z-punctuation z-separator z-comma z-java">,</span> key<span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">  <span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><p>There’s a scenario that we must discuss in more detail. We may have an entity that contains another entity (maybe in a one-to-one relation) and both are new entities not stored (yet) in the database. Although it seems a logic behaviour that when we persist the enclosing entity both are saved into the database, this is not the default behaviour. This is justified as cascading can be resource intensive when propagating to several instances, and probably most of them have not been modified which means we are wasting resources.<p>This functionality is defined by the “cascade” property that you can set when declaring relationships between entities (@OneToOne, etc). By default this property is empty so no persistence operation applied to one entity is propagated to related entities. You can change this by setting cascade to one of these values: MERGE, PERSIST, REFRESH, REMOVE or ALL. The first four tell the Entity Manager to propagate only the selected operation while the last one propagates all the persistence operations.<h2 id=query-api><a aria-label="Anchor link for: query-api" class="header-anchor no-hover-padding" href=#query-api><span aria-hidden=true class=link-icon></span></a> Query API</h2><p>The query API is a mechanism that allows you to find entities using SQL or JPQL, hiding the datasource behind the Entity Manager. It’s a complement to the find method that allows you to recover several related entities a once. It allows for two kind of queries: named and dynamic.<p>Named queries are intended to be stored and reused, allowing for some optimizations. They are defined at class level and can receive parameters, and one entity may have several named queries. Using named queries you can isolate the SQL/JPQL from the places where is used, making it more maintainable. You may even define them in xml descriptors, decoupling them from the code.<p>An example of a named query would be:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">Entity</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"></span></span><span class="z-meta z-annotation z-java"><span class="z-punctuation z-definition z-annotation z-java">@</span></span><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-identifier z-java"><span class="z-variable z-annotation z-java">NameQuery</span></span><span class="z-meta z-annotation z-parameters z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-variable z-parameter z-java">name</span><span class="z-keyword z-operator z-assignment z-java">=</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>findAll<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span>
</span></span></span><span class="z-source z-java"><span class="z-meta z-annotation z-java"><span class="z-meta z-annotation z-parameters z-java">   <span class="z-variable z-parameter z-java">query</span><span class="z-keyword z-operator z-assignment z-java">=</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>Select c from category c where c.name like :name<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-storage z-modifier z-java">public</span> <span class="z-meta z-class z-identifier z-java"><span class="z-storage z-type z-java">class</span> <span class="z-entity z-name z-class z-java">category</span></span> <span class="z-meta z-class z-implements z-java"><span class="z-keyword z-declaration z-implements z-java">implements</span> <span class="z-entity z-other z-inherited-class z-java">Serializable</span></span><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>fields and methods
</span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">  <span class="z-storage z-modifier z-java">public</span> <span class="z-support z-class z-java">Category</span> <span class="z-meta z-method z-java"><span class="z-meta z-method z-identifier z-java"><span class="z-entity z-name z-function z-java">getCategoryByName</span></span><span class="z-meta z-method z-parameters z-java"><span class="z-meta z-parens z-java"><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-support z-class z-java">String</span> <span class="z-variable z-parameter z-java">name</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java"><span class="z-punctuation z-section z-block z-begin z-java">{</span></span></span></span><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">   <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>assume em is an instance of the Persistence Manager (Entity Manager)
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">   <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>find named query by name
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">   <span class="z-support z-class z-java">Query</span> query <span class="z-meta z-assignment z-rhs z-java"><span class="z-keyword z-operator z-assignment z-java">=</span> em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">createNamedQuery</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>findAll<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">   query<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">setParamenter</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>name<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-separator z-comma z-java">,</span>name<span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span>
</span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">   <span class="z-keyword z-control z-flow z-return z-java">return</span> query<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">getResultList</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span> <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>returns list of entities
</span></span></span></span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-meta z-method z-java"><span class="z-meta z-method z-body z-java">  <span class="z-punctuation z-section z-block z-end z-java">}</span></span></span>
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java">
</span></span></span></span><span class="z-source z-java"><span class="z-meta z-class z-java"><span class="z-meta z-class z-body z-java"><span class="z-meta z-block z-java"><span class="z-punctuation z-section z-block z-end z-java">}</span></span></span></span>
</span><span class="z-source z-java">
</span></code></pre><p>Dynamic queries are generated “on the fly”, usually queries received from some other component. When possible is recommended to work with named queries, due to the performance enhancements they allow. En example of a dynamic query:<pre class="language-java z-code" data-lang=java><code class=language-java data-lang=java><span class="z-source z-java">
</span><span class="z-source z-java"><span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>assume em is an instance of the Persistence Manager (Entity Manager)
</span></span><span class="z-source z-java"><span class="z-support z-class z-java">Query</span> query <span class="z-meta z-assignment z-rhs z-java"><span class="z-keyword z-operator z-assignment z-java">=</span> em<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">createQuery</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-string z-quoted z-double z-java"><span class="z-punctuation z-definition z-string z-begin z-java">"</span>Select c from categories c<span class="z-punctuation z-definition z-string z-end z-java">"</span></span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span></span><span class="z-punctuation z-terminator z-java">;</span>
</span><span class="z-source z-java"><span class="z-keyword z-control z-flow z-return z-java">return</span> query<span class="z-punctuation z-accessor z-dot z-java">.</span><span class="z-meta z-function-call z-java"><span class="z-variable z-function z-java">getResultList</span><span class="z-punctuation z-section z-parens z-begin z-java">(</span><span class="z-punctuation z-section z-parens z-end z-java">)</span></span><span class="z-punctuation z-terminator z-java">;</span> <span class="z-comment z-line z-double-slash z-java"><span class="z-punctuation z-definition z-comment z-java">//</span>returns list of entities
</span></span><span class="z-source z-java">
</span></code></pre><h2 id=jpql-and-sql><a aria-label="Anchor link for: jpql-and-sql" class="header-anchor no-hover-padding" href=#jpql-and-sql><span aria-hidden=true class=link-icon></span></a> JPQL and SQL</h2><p>JPA accepts both JPQL and SQL for queries. Although they look quite similar, SQL works with the relational environment while JPQL works with entities, thus behaving in quite a different way behind the curtain. The recommendation for JPA is to use JPQL always, unless some odd exception requires us to use SQL.<p>I wont enter in details about JPQL as a brief tutorial won’t cut it. I recommend you to check a good book on the subject.</section><nav class="full-width article-navigation"><div><a aria-describedby=left_title aria-label=Next href=https://perevillega.com/posts/ejb-concepts-and-services/><span class=arrow>←</span> Next</a><p aria-hidden=true id=left_title>EJB Concepts and Services</div><div><a aria-describedby=right_title aria-label=Prev href=https://perevillega.com/posts/message-driven-beans/>Prev <span class=arrow>→</span></a><p aria-hidden=true id=right_title>Message-Driven Beans</div></nav></article></main><script defer src=https://perevillega.com/js/mermaid.min.js></script><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://perevillega.com/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://perevillega.com/atom.xml rel=noopener target=_blank> <img alt=feed loading=lazy src=https://perevillega.com/social_icons/rss.svg title=feed> </a><li class=js><a class="nav-links no-hover-padding social" data-encoded-email=cHZpbGxlZ2ErYmxvZ0BhcmFjb24uY29t href=#><img alt=email loading=lazy src=https://perevillega.com/social_icons/email.svg title=email> </a><li><a class="nav-links no-hover-padding social" rel="noopener me" href=https://github.com/pvillega target=_blank> <img alt=github loading=lazy src=https://perevillega.com/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel="noopener me" href=https://gitlab.com/pvillega target=_blank> <img alt=gitlab loading=lazy src=https://perevillega.com/social_icons/gitlab.svg title=gitlab> </a><li><a class="nav-links no-hover-padding social" rel="noopener me" href=https://bsky.app/profile/perevillega.com target=_blank> <img alt=bluesky loading=lazy src=https://perevillega.com/social_icons/bluesky.svg title=bluesky> </a><li><a class="nav-links no-hover-padding social" rel="noopener me" href=https://www.linkedin.com/in/perevillega/ target=_blank> <img alt=linkedin loading=lazy src=https://perevillega.com/social_icons/linkedin.svg title=linkedin> </a><li><a class="nav-links no-hover-padding social" rel="noopener me" href=https://stackoverflow.com/users/116791/pere-villega target=_blank> <img alt="stack overflow" title="stack overflow" loading=lazy src=https://perevillega.com/social_icons/stack-overflow.svg> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://perevillega.com/sitemap.xml> sitemap </a></ul> </small></nav><div class=credits><small> Powered by <a href=https://www.getzola.org rel=noopener target=_blank>Zola</a> & <a href=https://github.com/welpo/tabi rel=noopener target=_blank>tabi</a> </small></div></section><script async src=https://perevillega.com/js/decodeMail.min.js></script><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>