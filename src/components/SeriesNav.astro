---
import type { SeriesMeta, SeriesPost } from "@/utils/getSeries";
import { getPath } from "@/utils/getPath";
import IconChevronLeft from "@/assets/icons/IconChevronLeft.svg";
import IconChevronRight from "@/assets/icons/IconChevronRight.svg";

type Props = {
  seriesMeta: SeriesMeta;
  posts: SeriesPost[];
  currentOrder: number;
};

const { seriesMeta, posts, currentOrder } = Astro.props;

const currentIndex = posts.findIndex(p => p.seriesOrder === currentOrder);
const prevPart = currentIndex > 0 ? posts[currentIndex - 1] : null;
const nextPart = currentIndex < posts.length - 1 ? posts[currentIndex + 1] : null;

// Don't render if this is the only part
if (!prevPart && !nextPart) return;
---

<nav aria-label={`${seriesMeta.title} series navigation`} class="mt-6">
  <p class="mb-3 text-sm font-medium opacity-60">More in this series</p>
  <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
    {
      prevPart && (
        <a
          href={getPath(prevPart.post.id, prevPart.post.filePath)}
          class="flex w-full gap-1 hover:opacity-75"
        >
          <IconChevronLeft class="inline-block flex-none rtl:rotate-180" />
          <div>
            <span>Previous in series</span>
            <div class="text-sm text-accent/85">{prevPart.post.data.title}</div>
          </div>
        </a>
      )
    }
    {
      nextPart && (
        <a
          href={getPath(nextPart.post.id, nextPart.post.filePath)}
          class="flex w-full justify-end gap-1 text-end hover:opacity-75 sm:col-start-2"
        >
          <div>
            <span>Next in series</span>
            <div class="text-sm text-accent/85">{nextPart.post.data.title}</div>
          </div>
          <IconChevronRight class="inline-block flex-none rtl:rotate-180" />
        </a>
      )
    }
  </div>
</nav>
